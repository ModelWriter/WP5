<!doctype html>
<html ng-app>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html">
<title>Demo</title>
<link rel="stylesheet" type="text/css" media="all" href="css/styles.css">
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="js/Chart.js"></script>

</head>

<body ng-controller="GitHubCtrl">

	<div id="w">
		<div>
			<h1>Repository Summary Table</h1>

			<p>Enter a single GitHub organization name below and click the button to
				display </p>

			<input type="text" id="ghorganizationname" ng-model="username" style="float: left;" 
				placeholder="GitHub organization name..."> 
				
			<a href="#" id="ghsubmitbtn" style="float: left; margin-left: 10px;" ng-click="getRepos()">Get Repos</a>

			<!--a href="#" id="ghsubmitbtn" ng-click="getGitInfo()">Pull Repository Data</a> <br> <br-->

			<div style="clear:both;"></div>
			
			<div id="selection" style="display:none;" >
			
				<select name="select-repository" id="select-repository" onchange="fillFields()">
					<option disabled selected>Select repository</option>
				</select><br><br> 
				<select name="select-milestone" id="select-milestone">
					<option disabled selected>Select milestone</option>
				</select><br><br> 
				<select name="select-user" id="select-user">
					<option disabled selected>Select user</option>
				</select><br><br> 
				
				<select name="select-label" id="select-label">
					<option disabled selected>Select label</option>
				</select><br><br>

				<button id="ghsubmitbtn" onclick="drawTable()">Summary</button> 
				
			</div>
		
			<div id="table_div"></div>
			
			<div id="tableNotFound" style="display:none;">
				<h2>No User Info Found</h2>
			</div>

			<div id="ghapidata" class="clearfix"></div>
		</div>

		
		

		<div ng-show="userNotFound">
			<h2>No User Info Found</h2>
		</div>

		<div ng-show="loaded">

			<h2>
				{{user.name}} <span class="smallname">(@<a
					href="{{user.html_url}}" target="_blank"> {{user.login}} </a>)
				</span>
			</h2>

			<div class="ghcontent">
				<div class="avi">
					<a href="{{ user.html_url }}" target="_blank"> <img
						src="{{ user.avatar_url }}" width="80" height="80"
						alt="{{ user.login }}"></a>
				</div>
				Followers: {{ user.followers }} - Following: {{ user.following }}<br>Repos:
				{{ user.public_repos }}
				</p>
			</div>

			<div class="repolist clearfix">
				<p ng-hide="reposFound">No repos!</p>

				<div ng-show="reposFound">
					<p>
						<strong>Repos List:</strong>
					</p>
					<ul ng-repeat="repo in repos">
						<li><a href="{{repo.html_url}}" target="_blank">
								{{repo.name}} </a></li>
					</ul>
				</div>
			</div>
		</div>
		<a href="http://code.notsoclever.cc/simple-github-api-webapp-angularjs-style/">http://code.notsoclever.cc/simple-github-api-webapp-angularjs-style/</a>


	</div>


<!--script type="text/javascript" src="https://www.google.com/jsapi"></script-->
<script>
   function GitHubCtrl($scope, $http) {
      
       
       
	   // get user
	   $scope.getGitInfo = function () {
         $scope.userNotFound = false;
         $scope.loaded = false;

         $http.get("https://api.github.com/orgs/" + $scope.username)
               .success(function (data) {
                  if (data.name == "") data.name = data.login;
                  $scope.user = data;
                  $scope.loaded = true;
               })
               .error(function () {
                  $scope.userNotFound = true;
               });
         $http.get("https://api.github.com/orgs/" + $scope.username + "/repos").success(function (data) {
            $scope.repos = data;
            $scope.reposFound = data.length > 0;
         });
      }
	  		
	  // Get repos
	   $scope.getRepos = function() {
		  
		  document.getElementById('selection').style.display = "block";
		  
			$scope.repoNotFound = false;
			$scope.repoLoaded = false;

			$http.get("https://api.github.com/orgs/modelwriter" )
					.success(function(data) {
						if (data.name == "")
							data.name = data.login;				
						$scope.org = data;
						$scope.repoLoaded = true;
					}).error(function() {
						$scope.repoNotFound = true;
					});
			$http.get("https://api.github.com/orgs/modelwriter/repos").success(function(data) {
						$scope.repos = data;
						$scope.reposFound = data.length > 0;		
						
						fillRepositories(data);
						alert(data.length); 
						
					});
			
			
		
		// end drawTable

			 function fillRepositories(data){
				 
				 var selectbox = document.getElementById("select-repository");
				 
				 for(var i=selectbox.options.length-1;i>=1;i--)
	            {
					 //alert(i);
	                selectbox.remove(i);
	            }
				 
				 alert(data.length);
				 for(var i=0;i<$scope.repos.length;i++)
	            {    
	                 //alert(res.rows.item(i).ADI);
	                 var list = document.getElementById("select-repository");
	                 var option = document.createElement('option');
	                 alert(data[i].name);
	                 option.text = $scope.repos[i].name;
	                 option.value = $scope.repos[i].name;
	                 list.appendChild(option);
	            }
				 
			 }
		}
	
	
	$scope.fillFields = function(){
		
		var e = document.getElementById("select-repository");
       repoName = e.options[e.selectedIndex].value;
       
       fillIssues();
       fillLabels();
       fillMilestones();
       
       
       
       function fillIssues(){
       	
       	
       }
       
       function fillLabels(){
       	
       	
       }
       
       function fillMilestones(){
       	
       	
       }
       
	}
	
	// draw table
	
	
	
}   
   

	   
  
   
</script>



</body>
</html>
